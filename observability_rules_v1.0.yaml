metadata:
  name: Log Coverage Assessment Framework
  version: 1.0.0
  language: java
  description: >-
    Comprehensive assessment of log coverage and logging best practices for Java
    applications
  framework: observability
  author: Assessment Agent System
  created_date: 2025-10-18T00:00:00.000Z
  tags:
    - observability
    - logging
    - monitoring
file_processing:
  include_patterns:
    - '*.java'
  exclude_patterns: []
scoring_rules:
  grade_thresholds:
    excellent: 4.5
    good: 3.5
    fair: 2.5
    poor: 1.5
assessment_categories:
  - name: Log Coverage-1
    description: >-
      Are logs collected from all critical systems, services, and infrastructure
      components?
    weight: 8
    max_score: 5
    criteria:
      - name: log_coverage_presence
        description: Detect presence of logging statements in critical system components
        patterns:
          - logger\.info
          - logger\.debug
          - logger\.error
          - log\.info
          - log\.debug
          - log\.error
        scoring:
          comprehensive: 5
          partial: 3
          minimal: 1
        observation_template: Logging statements found in {count} critical components
        recommendations:
          missing: Add logging statements to all critical systems and services.
          partial: Increase logging coverage in critical components.
          good: Logging coverage is adequate for critical components.
        file_types:
          - '*.java'
  - name: Log Coverage-2
    description: What is current log coverage from critical services/servers?
    weight: 7
    max_score: 5
    criteria:
      - name: log_coverage_percentage
        description: Measure percentage of log coverage in critical services and servers
        patterns:
          - logger\.
          - log\.
        scoring:
          coverage_90_plus: 5
          coverage_70_90: 4
          coverage_50_70: 3
          coverage_30_50: 2
          coverage_below_30: 1
        observation_template: Log coverage is {percentage}% across critical services
        recommendations:
          missing: Establish logging in critical services to improve coverage.
          partial: Improve log coverage to exceed 70% in critical services.
          good: Log coverage is sufficient in critical services.
        file_types:
          - '*.java'
  - name: Log Centralization
    description: Are logs centralized in a unified platform for search and analysis?
    weight: 6
    max_score: 5
    criteria:
      - name: log_centralization_check
        description: Detect configuration or code indicating log centralization
        patterns:
          - logstash
          - fluentd
          - elk
          - graylog
          - splunk
          - kafka
        scoring:
          comprehensive: 5
          partial: 3
          minimal: 1
        observation_template: Log centralization tools/configuration detected in {count} files
        recommendations:
          missing: >-
            Implement log centralization using platforms like ELK, Splunk, or
            Fluentd.
          partial: Enhance log centralization coverage across services.
          good: Log centralization is properly configured.
        file_types:
          - '*.java'
          - '*.xml'
          - '*.yml'
  - name: Structured Logging
    description: >-
      Are logs structured (e.g., JSON) to support parsing, correlation, and
      enrichment?
    weight: 6.5
    max_score: 5
    criteria:
      - name: structured_logging_usage
        description: Identify usage of structured logging frameworks or JSON log formats
        patterns:
          - logstash-logback-encoder
          - jsonencoder
          - StructuredArguments
          - LoggingEvent
          - log\.info\(.*\{.*\}.*\)
        scoring:
          comprehensive: 5
          partial: 3
          minimal: 1
        observation_template: Structured logging detected in {count} files
        recommendations:
          missing: >-
            Adopt structured logging formats such as JSON for better log
            parsing.
          partial: Increase usage of structured logging in application logs.
          good: Structured logging is properly implemented.
        file_types:
          - '*.java'
          - '*.xml'
  - name: Log Enrichment
    description: >-
      Are logs enriched with contextual metadata (e.g., trace ID, user ID,
      environment)?
    weight: 6.5
    max_score: 5
    criteria:
      - name: log_enrichment_presence
        description: >-
          Detect enrichment of logs with contextual metadata like trace ID or
          user ID
        patterns:
          - MDC\.put
          - ThreadContext\.put
          - traceId
          - userId
          - environment
        scoring:
          comprehensive: 5
          partial: 3
          minimal: 1
        observation_template: Log enrichment with contextual metadata found in {count} files
        recommendations:
          missing: Add contextual metadata such as trace ID and user ID to logs.
          partial: Improve log enrichment coverage with contextual data.
          good: Logs are enriched with sufficient contextual metadata.
        file_types:
          - '*.java'
  - name: Log Retention & Rotation
    description: Are logs rotated and retained according to policy and compliance needs?
    weight: 5.5
    max_score: 5
    criteria:
      - name: log_rotation_config
        description: >-
          Detect log rotation and retention configuration in code or config
          files
        file_patterns:
          - logback\.xml
          - log4j2\.xml
          - '*.properties'
          - '*.yml'
        patterns:
          - <rollingPolicy>
          - maxHistory
          - logRetention
          - logRotation
        scoring:
          comprehensive: 5
          partial: 3
          minimal: 1
        observation_template: >-
          Log rotation and retention policies found in {count} configuration
          files
        recommendations:
          missing: >-
            Configure log rotation and retention policies to meet compliance
            requirements.
          partial: Review and improve log retention and rotation settings.
          good: Log retention and rotation policies are properly configured.
        file_types:
          - '*.xml'
          - '*.properties'
          - '*.yml'
  - description: Are logs easily searchable and queryable for troubleshooting and analysis?
    weight: 5
    max_score: 50
    criteria:
      - name: log_query_capability
        description: >-
          Detect presence of log indexing or query capabilities in logging
          infrastructure
        patterns:
          - elasticsearch
          - kibana
          - splunk
          - graylog
          - logsearch
        scoring:
          comprehensive: 5
          partial: 3
          minimal: 1
        observation_template: Log query and search tools detected in {count} files
        recommendations:
          missing: >-
            Implement log indexing and search tools for efficient
            troubleshooting.
          partial: Enhance log searchability and query capabilities.
          good: Logs are easily searchable and queryable.
        file_types:
          - '*.java'
          - '*.xml'
          - '*.yml'
    name: Log Query & Searchability
  - name: Log Alerting
    description: Are alerts generated based on log patterns, errors, or anomalies?
    weight: 5.5
    max_score: 5
    criteria:
      - name: log_alerting_setup
        description: Detect configuration or code for alerting on log events or anomalies
        patterns:
          - alertmanager
          - pagerduty
          - emailAlert
          - logAlert
          - thresholdAlert
        scoring:
          comprehensive: 5
          partial: 3
          minimal: 1
        observation_template: Log alerting configurations found in {count} files
        recommendations:
          missing: Set up alerting based on critical log patterns and anomalies.
          partial: Improve alerting coverage for log-based events.
          good: Log alerting is properly configured.
        file_types:
          - '*.java'
          - '*.yml'
          - '*.xml'
  - name: Log Correlation
    description: Are logs correlated with metrics and traces for root cause analysis?
    weight: 6
    max_score: 5
    criteria:
      - name: log_trace_correlation
        description: Detect correlation of logs with distributed tracing and metrics
        patterns:
          - traceId
          - spanId
          - correlationId
          - opentracing
          - jaeger
          - zipkin
        scoring:
          comprehensive: 5
          partial: 3
          minimal: 1
        observation_template: Log correlation with traces and metrics detected in {count} files
        recommendations:
          missing: >-
            Integrate logs with tracing and metrics for effective root cause
            analysis.
          partial: Enhance correlation between logs, metrics, and traces.
          good: Logs are well correlated with metrics and traces.
        file_types:
          - '*.java'
  - name: Log Ingestion Monitoring
    description: Is log ingestion monitored for delays, drops, or volume spikes?
    weight: 5
    max_score: 5
    criteria:
      - name: log_ingestion_monitoring
        description: Detect monitoring setup for log
